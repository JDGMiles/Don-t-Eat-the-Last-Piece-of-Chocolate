<!DOCTYPE html><html>
<head>
	<title>Don&rsquo;t Eat the Last Piece of Chocolate</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="shortcut icon" href="favicon.ico">
</head>

<body><center>

	<table style="position:absolute; left:10px; top:10px; background-color:black;">
		<td>
			<a href="#popup1"><img title="Information" src="../jdgmiles.github.io/questionmark.png" style="width:60px; height:60px"></a><br>
			<a href="https://twitter.com/jimdgmiles" target=blank_><img title="James Miles on Twitter" src="../jdgmiles.github.io/twitter.png" style="width:60px; height:60px"></a><br>
			<a href="http://jdgmiles.github.io/" target="_blank"><img title="Projects Page" src="../jdgmiles.github.io/jdgm.png" style="width:60px; height:60px"></a><br>
		</td>
	</table>

	<div id="popup1" class="overlay">
		<div class="popup">
			<a class="close" style="right: 30px;" href="#">&times;</a>
			<div style="font-family:Georgia; color:white; text-align:center; text-decoration:underline; font-size:230%">Don&rsquo;t Eat the Last Piece <br>of Chocolate</div>
			<span style="font-family:Georgia; font-size:170%; color:white; text-align:justify;"><br>Tap a piece of chocolate to highlight a portion of the bar.<br><br>Tap it again to eat those pieces.<br><br>Take turns with the opponent, and don&rsquo;t eat the last piece!<br></span>
		</div>
	</div>

	<table style="padding:0px 80px 0px 80px;" id="tablecontents">
	</table>
	<table>
		<tr>
		<td colspan="9"><center><br>
			<a id="instructions" style="font-family:Georgia; color:white; font-size:210%"><span onclick="aiturn()">Tap a piece, or tap here to go second</span></a>
		</center></td></tr>
	</table>

</center></body>
</html>

<script type="text/javascript">
var tablecolumns=9;
var tablerows=5;
var tablecontentsmarkup=" ";
var maxwidth=1000;
var maxheight=1100;
var cellsize=Math.min(Math.floor(maxwidth/tablecolumns), Math.floor(maxheight/tablerows));
var cellstate=[];
for(var i=0; i<tablecolumns*tablerows; i++){cellstate[i]=0;}
for(var i=0; i<tablerows; i++){
	tablecontentsmarkup=tablecontentsmarkup+"<tr>";
	for(var j=0; j<tablecolumns; j++){
		tablecontentsmarkup=tablecontentsmarkup+"<td class=\"gridcell\" id=\""+(i*tablecolumns+j)+"\" onclick=\"clicked("+(i*tablecolumns+j)+")\" style=\"width:"+cellsize+"px; height:"+cellsize+"px;\"><img src=\"ChocolatePiece.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\"></td>";
	}
	tablecontentsmarkup=tablecontentsmarkup+"</tr>";
}
var playerturn=0;
var testcell=0;
var validcell=0;
var cellstatecount=0;

document.getElementById("tablecontents").innerHTML=tablecontentsmarkup;

function clicked(cell){
	if(playerturn==0){
		if(cellstate[cell]==0){
			for(var i=0; i<(tablecolumns*tablerows); i++){
				if(cellstate[i]==2){cellstate[i]=0;}
				if((i%tablecolumns)>=(cell%tablecolumns) && i<(cell+tablecolumns) && cellstate[i]==0){document.getElementById(i).innerHTML="<img src=\"ChocolatePieceDarker.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\">";}
				else if(cellstate[i]==0){document.getElementById(i).innerHTML="<img src=\"ChocolatePiece.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\">";}
			}
			document.getElementById(cell).innerHTML="<img src=\"ChocolatePieceDarkerEatCheck.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\">";
			document.getElementById("instructions").innerHTML="Tap the tick to eat these pieces.";
			cellstate[cell]=2;
		}
		else if(cellstate[cell]==2){
			for(var i=0; i<(tablecolumns*tablerows); i++){
				if((i%tablecolumns)>=(cell%tablecolumns) && i<(cell+tablecolumns) && cellstate[i]==0){document.getElementById(i).innerHTML=""; cellstate[i]=1;}
				else if(cellstate[i]==0){document.getElementById(i).innerHTML="<img src=\"ChocolatePiece.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\">";}
			}
			document.getElementById(cell).innerHTML="";
			cellstate[cell]=1;
			if(cell==(tablecolumns*(tablerows-1))){document.getElementById("tablecontents").innerHTML="<tr><td><span onclick=\"window.location.href='index.html';\" style=\"font-family:Georgia; color:white; font-size:600%\"><br><br>You Lost &#9785;</span></td></tr>"; document.getElementById("instructions").innerHTML="<span onclick=\"window.location.href='index.html';\">Click here to play again.</span>";}
			else{playerturn=1; aiturn();}
		}
	}
}

function aiturn(){
	cellstatecount=0;
	for(var i=0; i<tablecolumns*tablerows; i++){cellstatecount+=cellstate[i];}
	if(cellstatecount==(tablecolumns*tablerows)-1){
		document.getElementById((tablecolumns*(tablerows-1))).innerHTML="";
		document.getElementById("tablecontents").innerHTML="<tr><td><span onclick=\"window.location.href='index.html';\" style=\"font-family:Georgia; color:white; font-size:600%\"><br><br>You Won!</span></td></tr>";
		document.getElementById("instructions").innerHTML="<span onclick=\"window.location.href='index.html';\">Click here to play again.</span>";}

	else {
		validcell=0;
		while(!validcell){
			testcell=Math.floor(tablerows*tablecolumns*Math.random());
			if(cellstate[testcell]==0 && testcell!=(tablecolumns*(tablerows-1))){validcell=1;}
		}
		for(var i=0; i<(tablecolumns*tablerows); i++){
			if((i%tablecolumns)>=(testcell%tablecolumns) && i<(testcell+tablecolumns) && cellstate[i]==0){document.getElementById(i).innerHTML=""; cellstate[i]=1;}
			else if(cellstate[i]==0){document.getElementById(i).innerHTML="<img src=\"ChocolatePiece.png\" style=\"width:"+cellsize+"px; height:"+cellsize+"px; display:block;\">";}
		}
		playerturn=0;
		document.getElementById("instructions").innerHTML="<span style=\"font-size:140%\">Your move</span>";
	}
}

</script>
